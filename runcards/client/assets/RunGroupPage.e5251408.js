import{h as M,i as q,j as Z,k as D,m as H,n as J,q as W,s as Q,v as j,x as U,_ as X,y as Y,z as $,B as b,C as ee,d as _,w as ne,D as te,P as f,l as B,E as oe,c as g,b as v,a as I,t as E,F as P,G as V,H as ae,I as re,J as ie,A as S,r as x,o as p,p as de,g as se}from"./index.804c9369.js";var le=["onActivate","onAddUndo","onBeforeAddUndo","onBeforeExecCommand","onBeforeGetContent","onBeforeRenderUI","onBeforeSetContent","onBeforePaste","onBlur","onChange","onClearUndos","onClick","onContextMenu","onCopy","onCut","onDblclick","onDeactivate","onDirty","onDrag","onDragDrop","onDragEnd","onDragGesture","onDragOver","onDrop","onExecCommand","onFocus","onFocusIn","onFocusOut","onGetContent","onHide","onInit","onKeyDown","onKeyPress","onKeyUp","onLoadContent","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp","onNodeChange","onObjectResizeStart","onObjectResized","onObjectSelected","onPaste","onPostProcess","onPostRender","onPreProcess","onProgressState","onRedo","onRemove","onReset","onSaveContent","onSelectionChange","onSetAttrib","onSetContent","onShow","onSubmit","onUndo","onVisualAid"],ce=function(e){return le.map(function(t){return t.toLowerCase()}).indexOf(e.toLowerCase())!==-1},ue=function(e,t,o){Object.keys(t).filter(ce).forEach(function(n){var i=t[n];typeof i=="function"&&(n==="onInit"?i(e,o):o.on(n.substring(2),function(d){return i(d,o)}))})},ve=function(e,t,o,n){var i=e.modelEvents?e.modelEvents:null,d=Array.isArray(i)?i.join(" "):i;M(n,function(l,s){o&&typeof l=="string"&&l!==s&&l!==o.getContent({format:e.outputFormat})&&o.setContent(l)}),o.on(d||"change input undo redo",function(){t.emit("update:modelValue",o.getContent({format:e.outputFormat}))})},me=function(e,t,o,n,i,d){n.setContent(d()),o.attrs["onUpdate:modelValue"]&&ve(t,o,n,i),ue(e,o.attrs,n)},G=0,N=function(e){var t=Date.now(),o=Math.floor(Math.random()*1e9);return G++,e+"_"+o+G+String(t)},fe=function(e){return e!==null&&e.tagName.toLowerCase()==="textarea"},O=function(e){return typeof e>"u"||e===""?[]:Array.isArray(e)?e:e.split(" ")},ge=function(e,t){return O(e).concat(O(t))},pe=function(e){return e==null},L=function(){return{listeners:[],scriptId:N("tiny-script"),scriptLoaded:!1}},ye=function(){var e=L(),t=function(i,d,l,s){var r=d.createElement("script");r.referrerPolicy="origin",r.type="application/javascript",r.id=i,r.src=l;var m=function(){r.removeEventListener("load",m),s()};r.addEventListener("load",m),d.head&&d.head.appendChild(r)},o=function(i,d,l){e.scriptLoaded?l():(e.listeners.push(l),i.getElementById(e.scriptId)||t(e.scriptId,i,d,function(){e.listeners.forEach(function(s){return s()}),e.scriptLoaded=!0}))},n=function(){e=L()};return{load:o,reinitialize:n}},Ce=ye(),he=function(){return typeof window<"u"?window:global},y=function(){var e=he();return e&&e.tinymce?e.tinymce:null},be={apiKey:String,cloudChannel:String,id:String,init:Object,initialValue:String,inline:Boolean,modelEvents:[String,Array],plugins:[String,Array],tagName:String,toolbar:[String,Array],modelValue:String,disabled:Boolean,tinymceScriptSrc:String,outputFormat:{type:String,validator:function(e){return e==="html"||e==="text"}}},C=globalThis&&globalThis.__assign||function(){return C=Object.assign||function(e){for(var t,o=1,n=arguments.length;o<n;o++){t=arguments[o];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},C.apply(this,arguments)},_e=function(e,t,o,n){return e(n||"div",{id:t,ref:o})},Se=function(e,t,o){return e("textarea",{id:t,visibility:"hidden",ref:o})},we=q({props:be,setup:function(e,t){var o=e.init?C({},e.init):{},n=Z(e),i=n.disabled,d=n.modelValue,l=n.tagName,s=D(null),r=null,m=e.id||N("tiny-vue"),a=e.init&&e.init.inline||e.inline,R=!!t.attrs["onUpdate:modelValue"],A=!0,z=e.initialValue?e.initialValue:"",k="",F=function(c){return R?function(){return d!=null&&d.value?d.value:""}:function(){return c?z:k}},w=function(){var c=F(A),u=C(C({},o),{readonly:e.disabled,selector:"#"+m,plugins:ge(o.plugins,e.plugins),toolbar:e.toolbar||o.toolbar,inline:a,setup:function(h){r=h,h.on("init",function(T){return me(T,e,t,h,d,c)}),typeof o.setup=="function"&&o.setup(h)}});fe(s.value)&&(s.value.style.visibility=""),y().init(u),A=!1};M(i,function(c){var u;r!==null&&(typeof((u=r.mode)===null||u===void 0?void 0:u.set)=="function"?r.mode.set(c?"readonly":"design"):r.setMode(c?"readonly":"design"))}),M(l,function(c){var u;R||(k=r.getContent()),(u=y())===null||u===void 0||u.remove(r),U(function(){return w()})}),H(function(){if(y()!==null)w();else if(s.value&&s.value.ownerDocument){var c=e.cloudChannel?e.cloudChannel:"5",u=e.apiKey?e.apiKey:"no-api-key",h=pe(e.tinymceScriptSrc)?"https://cdn.tiny.cloud/1/"+u+"/tinymce/"+c+"/tinymce.min.js":e.tinymceScriptSrc;Ce.load(s.value.ownerDocument,h,w)}}),J(function(){y()!==null&&y().remove(r)}),a||(W(function(){A||w()}),Q(function(){var c;R||(k=r.getContent()),(c=y())===null||c===void 0||c.remove(r)}));var K=function(c){var u;k=r.getContent(),(u=y())===null||u===void 0||u.remove(r),o=C(C({},o),c),U(function(){return w()})};return t.expose({rerender:K}),function(){return a?_e(j,m,s,e.tagName):Se(j,m,s)}}});const ke={components:{editor:we},setup(){Y(async()=>{await $.getGroupById(n.params.groupId),await b.getCardsInGroup(n.params.groupId),n.params.cardId&&b.setCurrentCard(l.value.find(a=>a.id===n.params.cardId)),n.query.station.length>0&&b.setZone(n.query.station,n.query.zone)});const e=D(!1),t=D({}),o=D(""),n=ee(),i=_(()=>S.selectedStation),d=_(()=>S.selectedZone),l=_(()=>S.cards),s=_(()=>S.currentCard),r=_(()=>S.currentGroup),m=_(()=>S.account);return ne(()=>{var a;t.value=s.value,o.value=(a=s.value)==null?void 0:a.content}),{edit:e,editCard:t,account:m,selectedStation:i,selectedZone:d,currentGroup:r,tinyApiKey:te,cards:l,currentCard:s,cardContent:o,async saveCardContent(){try{let a=s.value;a.content=o.value,await b.updateCard(a,a.id),f.toast("Run Card Content Updated!","success")}catch(a){B.error(a.message),f.toast("Something went wrong!","error")}},async updateCard(){try{await b.updateCard(t.value,t.value.id),e.value=!e.value,f.toast("Card Successfully Updated","success")}catch(a){B.log(a),f.toast(a.message,"error")}},async removeCard(){try{await f.confirm()&&(await b.deleteCard(s.value.id),oe.push({name:"group",params:{groupId:r.value.id,cardId:s.value.id},query:{station:i.value,zone:d.value}}),f.toast("Run Card Removed","success"))}catch(a){B.error(a),f.toast(a.message,"error")}}}}},Ie=e=>(de("data-v-c8b1b9c7"),e=e(),se(),e),Ee={class:"container"},Ve={class:"row justify-content-around mt-2"},xe={class:"col-md-3 d-none d-md-block pt-0"},De={key:0,class:"card col-md-6 pt-3 mt-2 shadow"},Re={class:"text-center mb-3"},Ae={key:0,class:"card-header text-center"},Be={key:0},Me=P(),Pe={class:"justify-self-end"},je={key:1,class:"card-header text-center"},Ue=P(),Ge={key:1,class:"card col-md-6 pt-3 my-3 shadow"},Oe=Ie(()=>v("div",{class:"card-body text-center"},[v("h3",null,"Create a New Run Card to begin!")],-1)),Le=[Oe],Ne={class:"col-md-3 mt-2"};function ze(e,t,o,n,i,d){const l=x("RelatedCards"),s=x("editor"),r=x("input-bar"),m=x("RunCardFormModal");return p(),g(ie,null,[v("div",Ee,[v("div",Ve,[v("div",xe,[I(l)]),n.currentCard?(p(),g("div",De,[v("div",Re,[v("h3",null,E(n.currentGroup.title),1)]),n.edit?V("",!0):(p(),g("div",Ae,[v("span",null,[v("i",{onClick:t[0]||(t[0]=a=>n.edit=!n.edit),class:"mdi mdi-pencil selectable"})]),P(" "+E(n.currentCard.title),1),n.selectedStation?(p(),g("span",Be," - "+E(n.selectedStation)+" - Zone "+E(n.selectedZone),1)):V("",!0),Me,v("span",Pe,[v("i",{onClick:t[1]||(t[1]=a=>n.removeCard()),class:"mdi mdi-trash-can text-danger selectable"})])])),n.edit?(p(),g("div",je,[ae(v("input",{"onUpdate:modelValue":t[2]||(t[2]=a=>n.editCard.title=a),type:"text"},null,512),[[re,n.editCard.title]]),Ue,v("span",null,[v("i",{onClick:t[3]||(t[3]=a=>n.updateCard()),class:"mdi mdi-check selectable"})])])):V("",!0),I(s,{class:"editor","output-format":"html",disabled:!n.account.admin,"api-key":n.tinyApiKey,init:{plugins:"preview importcss searchreplace autolink autosave save directionality code visualblocks visualchars fullscreen image link media template codesample table charmap pagebreak advlist lists nonbreaking anchor insertdatetime  wordcount help charmap quickbars emoticons",menubar:"file edit view insert format tools table help",toolbar:"undo redo | bold italic underline strikethrough | fontfamily fontsize blocks | alignleft aligncenter alignright alignjustify | outdent indent |  numlist bullist | forecolor backcolor removeformat | pagebreak | charmap emoticons | fullscreen  preview save print | insertfile image media template link anchor codesample | ltr rtl"},modelValue:n.cardContent,"onUpdate:modelValue":t[4]||(t[4]=a=>n.cardContent=a)},null,8,["disabled","api-key","modelValue"]),n.account.admin?(p(),g("button",{key:2,class:"btn btn-primary mt-3",onClick:t[5]||(t[5]=a=>n.saveCardContent())},"Save Card Content")):V("",!0)])):(p(),g("div",Ge,Le)),v("div",Ne,[I(r)])])]),I(m,{group:n.currentGroup},null,8,["group"])],64)}const Ke=X(ke,[["render",ze],["__scopeId","data-v-c8b1b9c7"]]);export{Ke as default};
